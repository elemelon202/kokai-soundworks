<% @musicians.each do |musician| %>
  <div class="record-item" data-page="<%= @pagy.page %>">
    <div class="musician-card position-relative">
      <%= link_to musician_path(musician), class: "text-light text-decoration-none stretched-link", data: { turbo: false } do %>
        <div class="musician-card-header">
          <% if musician.avatar.attached? %>
            <%= cl_image_tag(musician.avatar.key, class: "musician-avatar") %>
          <% elsif musician.media.attached? %>
            <% first_file = musician.media.first %>
            <% if first_file.content_type.start_with?("image") %>
              <%= cl_image_tag(first_file.key, class: "musician-avatar") %>
            <% end %>
          <% else %>
            <%= image_tag "musician_placeholder.jpg", class: "musician-avatar" %>
          <% end %>
          <div class="musician-card-name-wrapper">
            <h4 class="musician-card-name"><%= musician.name %></h4>
          </div>
        </div>
        <div class="musician-card-details">
          <p><i class="fa-solid fa-location-dot"></i> <%= musician.location %></p>
          <p><i class="fa-solid fa-guitar"></i> <%= musician.instrument %></p>
          <p><i class="fa-solid fa-music"></i> <%= musician.styles %></p>
          <p><i class="fa-solid fa-pen-to-square"></i> <%= musician.bio %></p>
        </div>
      <% end %>
      <%= button_to "Message", create_or_show_direct_messages_path(recipient_id: musician.user_id), method: :post, class: "btn btn-primary", style: "background-color: #a4fe35ff;", data: { turbo: false } %>
    </div>
  </div>
<% end %>
