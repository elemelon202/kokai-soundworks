<div class="col-md-6 col-lg-4">
  <%= link_to challenge_path(challenge), class: "text-decoration-none" do %>
    <div class="card h-100" style="background: #1e1e1e; border: 1px solid #2a2a2a; border-radius: 12px; overflow: hidden; transition: transform 0.2s, border-color 0.2s;" onmouseover="this.style.transform='translateY(-4px)'; this.style.borderColor='#E936AD'" onmouseout="this.style.transform='none'; this.style.borderColor='#2a2a2a'">
      <%# Video thumbnail %>
      <div style="position: relative; aspect-ratio: 16/9; background: #000;">
        <% if challenge.original_short.video.attached? %>
          <video muted preload="metadata" style="width: 100%; height: 100%; object-fit: cover;">
            <source src="<%= url_for(challenge.original_short.video) %>" type="<%= challenge.original_short.video.content_type %>">
          </video>
        <% end %>
        <%# Status badge %>
        <div style="position: absolute; top: 10px; right: 10px;">
          <% case challenge.status %>
          <% when 'open' %>
            <span class="badge" style="background: #C8E938; color: #000;">Open</span>
          <% when 'voting' %>
            <span class="badge" style="background: #E936AD; color: #fff;">Voting</span>
          <% when 'closed' %>
            <span class="badge" style="background: #666; color: #fff;">Closed</span>
          <% end %>
        </div>
        <%# Play icon overlay %>
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 48px; height: 48px; background: rgba(255,255,255,0.9); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
          <i class="fa-solid fa-play" style="color: #171717; font-size: 1.2rem; margin-left: 3px;"></i>
        </div>
      </div>

      <div class="card-body" style="padding: 16px;">
        <h5 class="card-title mb-2" style="color: #fff; font-size: 1rem;"><%= truncate(challenge.title, length: 40) %></h5>

        <div class="d-flex align-items-center mb-2">
          <% if challenge.creator.avatar.attached? %>
            <%= cl_image_tag(challenge.creator.avatar.key, style: "width: 24px; height: 24px; border-radius: 50%; object-fit: cover; margin-right: 8px;") %>
          <% else %>
            <div style="width: 24px; height: 24px; border-radius: 50%; background: #2a2a2a; display: flex; align-items: center; justify-content: center; margin-right: 8px;">
              <span style="color: #888; font-size: 0.6rem; font-weight: 600;"><%= challenge.creator.name[0].upcase %></span>
            </div>
          <% end %>
          <span style="color: #888; font-size: 0.85rem;"><%= challenge.creator.name %></span>
        </div>

        <div class="d-flex align-items-center gap-3" style="color: #666; font-size: 0.8rem;">
          <span><i class="fa-solid fa-users me-1"></i> <%= challenge.responses_count %> responses</span>
          <% if challenge.voting? || challenge.closed? %>
            <span><i class="fa-solid fa-check-to-slot me-1"></i> <%= challenge.challenge_responses.sum(:votes_count) %> votes</span>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>
</div>
